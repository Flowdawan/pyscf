

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4.17.2. SCF and DFT methods &mdash; PySCF 1.7.6 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.17.3. Density fitting for crystalline calculations" href="df.html" />
    <link rel="prev" title="4.17.1. Crystal structure" href="gto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">3. Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user.html">4. User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../gto.html">4.1. Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scf.html">4.2. Self-consistent field (SCF) methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft.html">4.3. Density functional theory (DFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mp.html">4.4. Second-Order Møller–Plesset Perturbation Theory (MP2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gw.html">4.5. GW approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci.html">4.6. Configuration interaction (CISD and FCI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cc.html">4.7. Coupled-cluster theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adc.html">4.8. Algebraic diagrammatic construction (ADC) scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agf2.html">4.9. Auxiliary second-order Green’s function perturbation theory (AGF2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mcscf.html">4.10. Multi-configuration self-consistent field (MCSCF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tddft.html">4.11. Time-dependent Hartree-Fock and Density Functional Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rt.html">4.12. Real-time time-dependent density functional theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solvent.html">4.13. Solvation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qmmm.html">4.14. QM/MM methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../x2c.html">4.15. Relativistic calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../df.html">4.16. Density fitting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../pbc.html">4.17. Periodic boundary conditions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gto.html">4.17.1. Crystal structure</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.17.2. SCF and DFT methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">4.17.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#density-fitting">4.17.2.2. Density fitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finite-size-effects">4.17.2.3. Finite-size effects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#band-structure-calculations">4.17.2.4. Band structure calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-ons">4.17.2.5. Add-ons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">4.17.2.6. References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="df.html">4.17.3. Density fitting for crystalline calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mix_mol.html">4.17.4. Mixing PBC and molecular modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../eph.html">4.18. Electron Phonon Matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../develop.html">5. Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">6. API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interface.html">7. Interfaces</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PySCF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../user.html"><span class="section-number">4. </span>User guide</a> &raquo;</li>
        
          <li><a href="../pbc.html"><span class="section-number">4.17. </span>Periodic boundary conditions</a> &raquo;</li>
        
      <li><span class="section-number">4.17.2. </span>SCF and DFT methods</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user/pbc/scf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="scf-and-dft-methods">
<span id="user-pbc-scf"></span><h1><span class="section-number">4.17.2. </span>SCF and DFT methods<a class="headerlink" href="#scf-and-dft-methods" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../../modules/scf.html#module-scf" title="scf: restricted and unrestricted, closed shell and open shell Hartree-Fock methods"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scf</span></code></a>, <a class="reference internal" href="../../modules/dft.html#module-dft" title="dft: Density functional theory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dft</span></code></a>, <a class="reference internal" href="../../modules/pbc/scf.html#module-pbc.scf" title="pbc.scf: Hartree-Fock methods with periodic boundary conditions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.scf</span></code></a>, <a class="reference internal" href="../../modules/pbc/dft.html#module-pbc.dft" title="pbc.dft: Density functional theory with periodic boundary conditions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.dft</span></code></a></p>
<div class="section" id="introduction">
<h2><span class="section-number">4.17.2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>PySCF supports periodic Hartree-Fock and density functional theory calculations
with Brillouin zone sampling.  The results of these calculations serve
as input to a variety of periodic post-HF and post-DFT calculations.
A minimal example of a periodic HF calculation on diamond with
a 2x2x2 sampling of the Brillouin zone is shown below.  Note that the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">kpts</span></code> keyword argument must be in physical units (inverse bohr),
which can be easily achieved using the <code class="docutils literal notranslate"><span class="pre">Cell.make_kpts()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;C 0.0000 0.0000 0.0000</span>
<span class="s1">              C 0.8917 0.8917 0.8917&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;0.0000 1.7834 1.7834</span>
<span class="s1">           1.7834 0.0000 1.7834</span>
<span class="s1">           1.7834 1.7834 0.0000&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="n">pseudo</span> <span class="o">=</span> <span class="s1">&#39;gth-pade&#39;</span><span class="p">,</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;gth-szv&#39;</span>
    <span class="p">)</span>

<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># converged SCF energy = -10.9308552994574</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="gto.html#user-pbc-gto"><span class="std std-ref">Crystal structure</span></a> and <a class="reference internal" href="../pbc.html#user-pbc"><span class="std std-ref">Periodic boundary conditions</span></a> for more details about
the <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code> object and Brillouin zone sampling.</p>
</div>
<div class="section" id="density-fitting">
<h2><span class="section-number">4.17.2.2. </span>Density fitting<a class="headerlink" href="#density-fitting" title="Permalink to this headline">¶</a></h2>
<p>All periodic calculations in PySCF must be done with some type of density
fitting.  The default behavior is to use plane-wave density fitting (FFTDF).
The number of plane-waves used as an auxiliary basis is controlled by kinetic
energy cutoff, which is specified by the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.ke_cutoff</span></code> parameter.  The
default value of this parameter is chosen to provide many digits of precision in
the ERIs and the subsequent energies.  If reduced precision is tolerable, this
parameter can be set manually, resulting in significant speedups and memory
savings.  For the diamond example above, lowering the kinetic energy cutoff to 100
hartree changes the SCF energy by about 5 microhartree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span><span class="o">.</span><span class="n">ke_cutoff</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="c1"># in Hartree</span>
<span class="n">cell</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># converged SCF energy = -10.9308602914696</span>
</pre></div>
</div>
<p>For many systems, Gaussian density fitting (GDF) is more economical, although it
incurs larger errors than FFTDF.  Periodic GDF can be activated in the same way
as for molecules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">()</span><span class="o">.</span><span class="n">density_fit</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>If a corresponding auxiliary basis is found for the chosen atomic orbital basis,
it will be used.  Otherwise, an even-tempered Gaussian basis will be used.</p>
<p>See <a class="reference internal" href="df.html#user-pbc-df"><span class="std std-ref">Density fitting for crystalline calculations</span></a> for more details about periodic density fitting.</p>
</div>
<div class="section" id="finite-size-effects">
<h2><span class="section-number">4.17.2.3. </span>Finite-size effects<a class="headerlink" href="#finite-size-effects" title="Permalink to this headline">¶</a></h2>
<p>The long-ranged nature of the Coulomb interaction is responsible for a number of
divergent contributions to the energy.  For charge-neutral unit cells, the
divergence of the nuclear repulsion energy, the electron-nuclear attraction
energy, and the electronic Hartree energy cancel one another.</p>
<p>The nonlocal exact exchange energy exhibits an integrable divergence at
<span class="math notranslate nohighlight">\(G=0\)</span> that is responsible for the leading-order finite-size error of HF
and hybrid DFT calculations <a class="bibtex reference internal" href="#paier2005" id="id1">[1]</a><a class="bibtex reference internal" href="#broqvist2009" id="id2">[2]</a><a class="bibtex reference internal" href="#sundararaman2013" id="id3">[3]</a>.  In
PySCF, this exchange divergence can be addressed in a number of ways using the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">exxdiv</span></code> keyword argument to the mean-field class, with the following
possible values.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'ewald'</span></code> (default)</p>
<p>The <span class="math notranslate nohighlight">\(G=0\)</span> value of the Coulomb potential is the supercell Madelung
constant <a class="bibtex reference internal" href="#paier2005" id="id4">[1]</a><a class="bibtex reference internal" href="#broqvist2009" id="id5">[2]</a><a class="bibtex reference internal" href="#sundararaman2013" id="id6">[3]</a>, which is evaluated by
Ewald summation.  The finite-size error of the exchange energy decays as
<span class="math notranslate nohighlight">\(N_k^{-1}\)</span>, where <span class="math notranslate nohighlight">\(N_k\)</span> is the number of k-points sampled in the
Brillouin zone.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
<p>The <span class="math notranslate nohighlight">\(G=0\)</span> value of the Coulomb potential is set to zero.  The
finite-size error of the exchange energy decays slowly as <span class="math notranslate nohighlight">\(N_k^{-1/3}\)</span>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'vcut_sph'</span></code></p>
<p>The Coulomb potential is spherically truncated in real space at a radius equal
to half of the supercell side length <a class="bibtex reference internal" href="#spencer2008" id="id7">[4]</a>.  The finite-size
error of the exchange energy decays as <span class="math notranslate nohighlight">\(\exp(-aN_k^{1/3})\)</span>.  Only
supported with plane-wave density fitting (FFTDF).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'vcut_ws'</span></code></p>
<p>The Coulomb potential is truncated outside of the Wigner-Seitz supercell
<a class="bibtex reference internal" href="#sundararaman2013" id="id8">[3]</a>, which is more appropriate than spherical truncation
for anisotropic cells.  The finite-size error of the exchange energy decays as
<span class="math notranslate nohighlight">\(\exp(-aN_k^{1/3})\)</span>.  Only supported with plane-wave density fitting
(FFTDF).</p>
</li>
</ul>
<p>An example calculation with exchange treated with the spherically truncated
Coulomb potential is shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">,</span> <span class="n">exxdiv</span><span class="o">=</span><span class="s1">&#39;vcut_sph&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="band-structure-calculations">
<h2><span class="section-number">4.17.2.4. </span>Band structure calculations<a class="headerlink" href="#band-structure-calculations" title="Permalink to this headline">¶</a></h2>
<p>After an SCF calculation has been performed, the band structure can be
calculated non-self-consistently along a k-point path using the
<code class="docutils literal notranslate"><span class="pre">SCF.get_bands(kpts)</span></code> function, where <code class="docutils literal notranslate"><span class="pre">kpts</span></code> is a list of k-points along
which the band structure is desired.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For Hartree-Fock or hybrid DFT, the discontinuity of the exchange potential
at <span class="math notranslate nohighlight">\(G=0\)</span> is problematic for band structure calculations.  Using
<code class="xref py py-attr docutils literal notranslate"><span class="pre">exxdiv='vcut_sph'</span></code> with FFTDF is recommended instead.  Alternatively,
the SCF procedure can be repeated at each k-point, which is much more
expensive but allows the use of any <code class="xref py py-attr docutils literal notranslate"><span class="pre">exxdiv</span></code> or density fitting.</p>
</div>
<p>See <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/pbc/09-band_ase.py">examples/pbc/09-band_ase.py</a> for an example DFT band structure
calculation.</p>
</div>
<div class="section" id="add-ons">
<h2><span class="section-number">4.17.2.5. </span>Add-ons<a class="headerlink" href="#add-ons" title="Permalink to this headline">¶</a></h2>
<p>All molecular SCF add-ons are also available for periodic SCF but
must be accessed through the molecular <a class="reference internal" href="../../modules/scf.html#module-pyscf.scf.addons" title="pyscf.scf.addons"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.scf.addons</span></code></a> module.
Here we highlight a few of the most useful add-ons.</p>
<div class="section" id="linear-dependencies">
<h3><span class="section-number">4.17.2.5.1. </span>Linear dependencies<a class="headerlink" href="#linear-dependencies" title="Permalink to this headline">¶</a></h3>
<p>The dense packing of atoms in solids combined with the use of diffuse
atom-centered basis functions is responsible for frequent linear dependencies.
The linear dependency can be eliminated by Cholesky orthogonalization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span> <span class="k">as</span> <span class="n">mol_scf</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">)</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">mol_scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">remove_linear_dep_</span><span class="p">(</span><span class="n">kmf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="smearing">
<h3><span class="section-number">4.17.2.5.2. </span>Smearing<a class="headerlink" href="#smearing" title="Permalink to this headline">¶</a></h3>
<p>For metals or small band gap semiconductors, it can be useful to smear the
orbital occupation numbers away from integer values.  This can improve SCF
convergence and can expedite convergence to the thermodynamic limit with k-point
sampling.  Because this approach assumes a finite electronic temperature, it
yields an entropy and free energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">)</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">smearing_</span><span class="p">(</span><span class="n">kmf</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fermi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Entropy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kmf</span><span class="o">.</span><span class="n">entropy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Free energy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kmf</span><span class="o">.</span><span class="n">e_free</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zero temperature energy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">kmf</span><span class="o">.</span><span class="n">e_tot</span><span class="o">+</span><span class="n">kmf</span><span class="o">.</span><span class="n">e_free</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>Fermi-Dirac smearing (<code class="xref py py-attr docutils literal notranslate"><span class="pre">method='fermi'</span></code>) and Gaussian smearing
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">method='gauss'</span></code>) are supported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because most functions in PySCF assume integer occupations, they may fail if
combined with a mean-field calculation that was performed with smearing.</p>
</div>
</div>
<div class="section" id="stability">
<h3><span class="section-number">4.17.2.5.3. </span>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h3>
<p>Periodic SCF solutions can be checked with stability analysis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">kmf</span><span class="o">.</span><span class="n">stability</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="references">
<h2><span class="section-number">4.17.2.6. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-user/pbc/scf-0"><dl class="citation">
<dt class="bibtex label" id="paier2005"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>Joachim Paier, Robin Hirschl, Martijn Marsman, and Georg Kresse. The perdew–burke–ernzerhof exchange-correlation functional applied to the g2-1 test set using a plane-wave basis set. <em>J. Chem. Phys.</em>, 122(23):234102, 2005. <a class="reference external" href="https://doi.org/10.1063/1.1926272">doi:10.1063/1.1926272</a>.</p>
</dd>
<dt class="bibtex label" id="broqvist2009"><span class="brackets">2</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>Peter Broqvist, Audrius Alkauskas, and Alfredo Pasquarello. Hybrid-functional calculations with plane-wave basis sets: effect of singularity correction on total energies, energy eigenvalues, and defect energy levels. <em>Phys. Rev. B</em>, 80:085114, Aug 2009. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.80.085114">doi:10.1103/PhysRevB.80.085114</a>.</p>
</dd>
<dt class="bibtex label" id="sundararaman2013"><span class="brackets">3</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id6">2</a>,<a href="#id8">3</a>)</span></dt>
<dd><p>Ravishankar Sundararaman and T. A. Arias. Regularization of the coulomb singularity in exact exchange by wigner-seitz truncated interactions: towards chemical accuracy in nontrivial systems. <em>Phys. Rev. B</em>, 87:165122, Apr 2013. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.87.165122">doi:10.1103/PhysRevB.87.165122</a>.</p>
</dd>
<dt class="bibtex label" id="spencer2008"><span class="brackets"><a class="fn-backref" href="#id7">4</a></span></dt>
<dd><p>James Spencer and Ali Alavi. Efficient calculation of the exact exchange energy in periodic systems using a truncated coulomb potential. <em>Phys. Rev. B</em>, 77:193110, May 2008. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.77.193110">doi:10.1103/PhysRevB.77.193110</a>.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="df.html" class="btn btn-neutral float-right" title="4.17.3. Density fitting for crystalline calculations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="gto.html" class="btn btn-neutral float-left" title="4.17.1. Crystal structure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015-2021, The PySCF Developers.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>