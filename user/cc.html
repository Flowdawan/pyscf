

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4.7. Coupled-cluster theory &mdash; PySCF 1.7.6 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.8. Algebraic diagrammatic construction (ADC) scheme" href="adc.html" />
    <link rel="prev" title="4.6. Configuration interaction (CISD and FCI)" href="ci.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">3. Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user.html">4. User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gto.html">4.1. Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="scf.html">4.2. Self-consistent field (SCF) methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="dft.html">4.3. Density functional theory (DFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mp.html">4.4. Second-Order Møller–Plesset Perturbation Theory (MP2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gw.html">4.5. GW approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci.html">4.6. Configuration interaction (CISD and FCI)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.7. Coupled-cluster theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">4.7.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spin-symmetry">4.7.2. Spin symmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#properties">4.7.3. Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frozen-orbitals">4.7.4. Frozen orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#equation-of-motion-coupled-cluster-theory">4.7.5. Equation-of-motion coupled-cluster theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#job-control">4.7.6. Job control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#saving-and-restarting">4.7.6.1. Saving and restarting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-diis">4.7.6.2. Modifying DIIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integral-direct-ccsd">4.7.6.3. Integral-direct CCSD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="adc.html">4.8. Algebraic diagrammatic construction (ADC) scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="agf2.html">4.9. Auxiliary second-order Green’s function perturbation theory (AGF2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mcscf.html">4.10. Multi-configuration self-consistent field (MCSCF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tddft.html">4.11. Time-dependent Hartree-Fock and Density Functional Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="rt.html">4.12. Real-time time-dependent density functional theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvent.html">4.13. Solvation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="qmmm.html">4.14. QM/MM methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="x2c.html">4.15. Relativistic calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="df.html">4.16. Density fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbc.html">4.17. Periodic boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="eph.html">4.18. Electron Phonon Matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">5. Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">6. API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interface.html">7. Interfaces</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PySCF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../user.html"><span class="section-number">4. </span>User guide</a> &raquo;</li>
        
      <li><span class="section-number">4.7. </span>Coupled-cluster theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user/cc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="coupled-cluster-theory">
<span id="user-cc"></span><h1><span class="section-number">4.7. </span>Coupled-cluster theory<a class="headerlink" href="#coupled-cluster-theory" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../modules/cc.html#module-cc" title="cc: Coupled cluster energies and properties"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cc</span></code></a>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.cc</span></code></p>
<p>The MP2 and coupled-cluster functionalities of PySCF are similar.  See
also <a class="reference internal" href="mp.html#user-mp2"><span class="std std-numref">Section 4.4</span></a>.</p>
<div class="section" id="introduction">
<h2><span class="section-number">4.7.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Coupled-cluster (CC) theory is a post-Hartree-Fock method capable of describing
electron correlation in the ground state.  It is size extensive but not
variational.
PySCF has extensive support for CC calculations with single and double excitations (CCSD).
It can also include a perturbative treatment of triple excitations (CCSD(T)),
which is a very accurate method for single-reference quantum chemistry.
CC calculations can be performed with or without density fitting,
depending on the initial SCF calculation.
Correlated excited states are
accessible through the equation-of-motion (EOM) CCSD framework, described below.</p>
<p>A minimal example of a CCSD and CCSD(T) calculation is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;H 0 0 0; F 0 0 1.1&#39;</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span>
    <span class="n">symmetry</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># Note that the line following these comments could be replaced by</span>
<span class="c1"># mycc = cc.CCSD(mf)</span>
<span class="c1"># mycc.kernel()</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CCSD total energy&#39;</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
<span class="n">et</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ccsd_t</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CCSD(T) total energy&#39;</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span> <span class="o">+</span> <span class="n">et</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spin-symmetry">
<h2><span class="section-number">4.7.2. </span>Spin symmetry<a class="headerlink" href="#spin-symmetry" title="Permalink to this headline">¶</a></h2>
<p>The CC module in PySCF supports a number of reference wave functions with
broken spin symmetry.  In particular, CC can be performed with a
spin-restricted, spin-unrestricted, and general (spin-mixed) Hartree-Fock
solution, leading to the RCCSD, UCCSD, and GCCSD methods.</p>
<p>The module-level <code class="docutils literal notranslate"><span class="pre">cc.CCSD(mf)</span></code> constructor can infer the correct method based
on the level of symmetry-breaking in the mean-field argument.  For more explicit
control or inspection, the respective classes and functions can be found in
<code class="docutils literal notranslate"><span class="pre">ccsd.py</span></code> (restricted with real orbitals), <code class="docutils literal notranslate"><span class="pre">rccsd.py</span></code> (restricted with
potentially complex orbitals), <code class="docutils literal notranslate"><span class="pre">uccsd.py</span></code> (unrestricted), and <code class="docutils literal notranslate"><span class="pre">gccsd.py</span></code>
(general).</p>
<p>For example, a spin-unrestricted calculation on triplet oxygen can be performed
as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;O 0 0 0; O 0 0 1.2&#39;</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span>
    <span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># this is UHF</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># this is UCCSD</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;UCCSD total energy = &#39;</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="properties">
<h2><span class="section-number">4.7.3. </span>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<p>A number of properties are available at the CCSD level.</p>
<p>Unrelaxed 1- and 2-electron reduced density matrices can be calculated.
They are returned in the MO basis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dm1</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="n">dm2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">make_rdm2</span><span class="p">()</span>
</pre></div>
</div>
<p>Analytical nuclear gradients can be calculated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mygrad</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The CCSD Lambda equations can be solved:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">solve_lambda</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="frozen-orbitals">
<h2><span class="section-number">4.7.4. </span>Frozen orbitals<a class="headerlink" href="#frozen-orbitals" title="Permalink to this headline">¶</a></h2>
<p>By default, CCSD calculations in PySCF correlate all electrons in all available
orbitals. To freeze the lowest-energy core orbitals,
use the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>To freeze occupied and/or unoccupied orbitals with finer control, a list of
0-based orbital indices can be provided as the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># freeze 2 core orbitals</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># freeze 2 core orbitals and 3 unoccupied orbitals</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="equation-of-motion-coupled-cluster-theory">
<h2><span class="section-number">4.7.5. </span>Equation-of-motion coupled-cluster theory<a class="headerlink" href="#equation-of-motion-coupled-cluster-theory" title="Permalink to this headline">¶</a></h2>
<p>EOM-CCSD can be used to calculate neutral excitation energies (EE-EOM-CCSD),
spin-flip excitations (SF-EOM-CCSD),
or charged excitations, i.e. ionization potentials (IP-EOM-CCSD) or electron affinities
(EA-EOM-CCSD).  The EOM functions return the requested number of
eigenvalues and right-hand eigenvectors. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">e_ip</span><span class="p">,</span> <span class="n">c_ip</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ipccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ea</span><span class="p">,</span> <span class="n">c_ea</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eaccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ee</span><span class="p">,</span> <span class="n">c_ee</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_sf</span><span class="p">,</span> <span class="n">c_sf</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomsf_ccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">eecsd()</span></code> function returns neutral excitations with all possible spin
multiplicities.  For closed-shell calculations (RHF and RCCSD), singlet and triplet
excitations can be requested explicitly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e_s</span><span class="p">,</span> <span class="n">c_s</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomee_ccsd_singlet</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_t</span><span class="p">,</span> <span class="n">c_t</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomee_ccsd_triplet</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, PySCF calculates the <code class="docutils literal notranslate"><span class="pre">nroots</span></code> eigenvalues with the lowest energy,
which may include states with dominant double-excitation character.  To only
calculate states with dominant single-excitation character, use the <code class="docutils literal notranslate"><span class="pre">koopmans</span></code>
keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">koopmans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>An initial guess wavefunction may be provided, in which case PySCF will try to
find the most similar EOM solution vector:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf.cc.eom_rccsd</span> <span class="kn">import</span> <span class="n">amplitudes_to_vector_ee</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span><span class="n">nvir</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">nvir</span><span class="p">,</span><span class="n">nvir</span><span class="p">))</span>
<span class="n">r1</span><span class="p">[</span><span class="n">occ_index</span><span class="p">,</span><span class="n">vir_index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">myguess</span> <span class="o">=</span> <span class="n">amplitudes_to_vector_ee</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">)</span>
<span class="n">e_s</span><span class="p">,</span> <span class="n">c_s</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomee_ccsd_singlet</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">myguess</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="job-control">
<h2><span class="section-number">4.7.6. </span>Job control<a class="headerlink" href="#job-control" title="Permalink to this headline">¶</a></h2>
<div class="section" id="saving-and-restarting">
<h3><span class="section-number">4.7.6.1. </span>Saving and restarting<a class="headerlink" href="#saving-and-restarting" title="Permalink to this headline">¶</a></h3>
<p>To allow for future restarts, the SCF information
and the CCSD DIIS information must be saved:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">chkfile</span> <span class="o">=</span> <span class="s1">&#39;hf.chk&#39;</span>
<span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">diis_file</span> <span class="o">=</span> <span class="s1">&#39;ccdiis.h5&#39;</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>To restart a CCSD calculation, first the molecule and SCF information must
be restored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load_mol</span><span class="p">(</span><span class="s1">&#39;hf.chk&#39;</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;hf.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;scf&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Next, the CCSD calculation can be restarted by using the previous
CCSD amplitudes as the initial guess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">restore_from_diis_</span><span class="p">(</span><span class="s1">&#39;ccdiis.h5&#39;</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">t2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="modifying-diis">
<h3><span class="section-number">4.7.6.2. </span>Modifying DIIS<a class="headerlink" href="#modifying-diis" title="Permalink to this headline">¶</a></h3>
<p>The parameters of the DIIS algorithm can be tuned in cases where
convergence is difficult.  To increase the size of the DIIS space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">diis_space</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>By default, DIIS is activated on the first CCSD iteration.  Sometimes
it can be helpful to postpone the use of DIIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">diis_start_cycle</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="integral-direct-ccsd">
<h3><span class="section-number">4.7.6.3. </span>Integral-direct CCSD<a class="headerlink" href="#integral-direct-ccsd" title="Permalink to this headline">¶</a></h3>
<p>In order to avoid large memory requirements, the default behavior in CCSD calculations
is to store most two-electron integral tensors on disk.  This leads to a
potential I/O bottleneck.  For medium-sized molecules, an integral-direct
AO-driven implementation can be more efficient.  The user must manually
request an integral-direct CCSD calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">direct</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">e_corr</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="adc.html" class="btn btn-neutral float-right" title="4.8. Algebraic diagrammatic construction (ADC) scheme" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ci.html" class="btn btn-neutral float-left" title="4.6. Configuration interaction (CISD and FCI)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015-2021, The PySCF Developers.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>